<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

<ui:composition template="/WEB-INF/template.xhtml">

    <ui:define name="content">
        <div class="Container100">
            <div class="ContainerIndent">
                <script type="text/javascript" src="#{request.contextPath}/resources/js/highcharts.js"></script>
                <script type="text/javascript" src="#{request.contextPath}/resources/js/highcharts-more.js"></script>
                <script type="text/javascript" src="#{request.contextPath}/resources/js/exporting.js"></script>

                <f:event type="preRenderView" listener="#{presupuestoController.findProyecto(proyectoController.selected.id)}"/>
                <f:event type="preRenderView" listener="#{presupuestoController.sumarGastosView()}"/>

                <h:form id="form">

                    <p:tooltip/>

                    <p:commandButton value="Idea Proyecto - Resumen" icon="fa fa-stack-exchange"
                                     styleClass="Fright OrangeButton FloatNoneOnMobile"
                                     actionListener="#{proyectoController.mostrarDialogIdeaProyecto()}"/>


                    <div class="Card ">
                        <div class="ui-fluid">
                            <div class="CardTopic">
                                <i class="icon-list Fs30 Fleft MarRight10"></i>

                                <div class="EmptyBox10 ShowOnMobile"></div>
                                Proyecto N° #{proyectoController.selected.id} <br/>
                                <span class="CardSubTopic"> #{proyectoController.selected.nombre} </span>

                                <div class="SeparatorFull"></div>

                                <p:tabView id="tabview1">

                                    <p:tab id="panelequipo" title="Equipo de Trabajo">

                                        <p:panelGrid columns="3" layout="grid" columnClasses="ui-grid-col-4 Padding15px, ui-grid-col-6 Padding15px, ui-grid-col-2 Padding15px">
                                            <div class="CardTopic">
                                                <i class="icon-user Fs30 Fleft MarRight10"></i>
                                                <div class="EmptyBox10 ShowOnMobile"></div>
                                                Agregar Personas al Equipo  <br/>
                                                <span class="CardSubTopic"> Seleccionar docentes-investigadores del equipo. </span>
                                            </div>

                                            <p:selectOneMenu id="advancedfiltroa"
                                                             value="#{agenteViewController.selected}" filter="true"
                                                             filterMatchMode="contains">
                                                <p:ajax update="agregaraequipo"/>
                                                <f:selectItems value="#{agenteViewController.itemsAvailableSelectOne}"/>
                                            </p:selectOneMenu>

                                            <h:panelGrid columns="6" id="agenteselecciona">
                                                <p:commandButton
                                                        title="Agregar al Equipo de Trabajo de la Idea-Proyecto"
                                                        icon="fa fa-plus" id="agregaraequipo" immediate="true"
                                                        update="agentesa"
                                                        action="#{proyectoAgenteController.agregarEquipo}"
                                                        disabled="${empty agenteViewController.selected.apellido ? 'true' : 'false'}" styleClass="GreenButton White" />

                                                <p:commandButton title="Nueva Persona" icon="fa fa-user-plus" onclick="PF('dregistrar').show();" styleClass="OrangeButton White"/>
                                            </h:panelGrid>
                                        </p:panelGrid>

                                        <div align="center">
                                            <p:dataTable id="agentesa" value="#{proyectoAgenteController.equipotrabajo}"
                                                         var="agentea" editable="true" editMode="cell"
                                                         rowIndexVar="indice"

                                                         styleClass="tabla TablaColorEncabezado tablaAjustada">
                                                <p:column styleClass="TexAlCenter">
                                                    <f:facet name="header">
                                                        <h:outputText value="Cuil"/>
                                                    </f:facet>
                                                    <h:outputText value="#{agentea.agente.cuil}"/>
                                                </p:column>
                                                <p:column styleClass="TexAlCenter">
                                                    <f:facet name="header">
                                                        <h:outputText value="Nombre y Apellido"/>
                                                    </f:facet>
                                                    <h:outputText
                                                            value="#{agentea.agente.apellido}, #{agentea.agente.nombres}"/>
                                                </p:column>

                                                <p:column styleClass="TexAlCenter">
                                                    <f:facet name="header">
                                                        <h:outputText value="Función en el Proyecto"
                                                                      style="font-weight: bold;"
                                                                      title="Ingrese la función del agente en el proyecto."/>
                                                    </f:facet>
                                                    <p:cellEditor>
                                                        <f:facet name="output">
                                                            <!--<h:outputLabel id="outputfuncion" value="# {agentea.funcionproyecto}" title="Función a cumplir por el agente en el proyecto." />-->
                                                            <p:inputText id="outputfuncion"
                                                                         value="#{agentea.funcionproyecto}"
                                                                         title="Función que va cumplir el agente en el proyecto."/>
                                                            <p:tooltip id="toolTipOutputFuncion" for="outputfuncion"
                                                                       showEvent="focus" hideEvent="blur"/>
                                                        </f:facet>
                                                        <f:facet name="input">
                                                            <p:inputText id="ifuncion"
                                                                         value="#{agentea.funcionproyecto}"
                                                                         title="Función que va cumplir el agente en el proyecto."/>
                                                            <p:tooltip id="toolTipInputFuncion" for="ifuncion"
                                                                       showEvent="focus" hideEvent="blur"/>
                                                        </f:facet>
                                                    </p:cellEditor>
                                                </p:column>


                                                <p:column styleClass="TexAlCenter" style="vertical-align: middle;">
                                                    <f:facet name="header">
                                                        <h:outputText value="Participación" style="font-weight: bold;"
                                                                      title="Click e indique si el agente es consultor externo."/>
                                                    </f:facet>
                                                    <p:cellEditor>
                                                        <f:facet name="output">
                                                            <p:selectBooleanCheckbox id="ssconsultorexterno"
                                                                                     value="#{agentea.consultorexterno}"
                                                                                     style="width:20px; "/>
                                                            <h:outputLabel id="labelConsultorexterno"
                                                                           value="#{agentea.consultorexterno eq 'TRUE' ? ' Consultor ':' Docente '}"
                                                                           style="font-size: 18px; "/>
                                                        </f:facet>
                                                        <f:facet name="input">
                                                            <!--                                                            <p:selectBooleanButton onLabel="Consultor" offLabel="Docente" id="sconsultorexterno" value="# {agentea.consultorexterno}"  >
                                                                                                                                <p:ajax update="@this :formprincipal:tabviewTodo:agentesa"  />
                                                                                                                            </p:selectBooleanButton>-->
                                                            <p:selectBooleanCheckbox id="sconsultorexterno"
                                                                                     value="#{agentea.consultorexterno}"
                                                                                     style="width:20px; ">
                                                                <p:ajax update="ssconsultorexterno labelConsultorexterno labelConsultorexterno2 ihorasdisponibles horasdedicacion"
                                                                        oncomplete="$(function(){PrimeFaces.focus(':formprincipal:tabviewTodo:horasdedicacion');});"/>
                                                            </p:selectBooleanCheckbox>
                                                            <h:outputLabel id="labelConsultorexterno2"
                                                                           value="#{agentea.consultorexterno eq 'TRUE' ? ' Consultor ':' Docente '}"
                                                                           style="font-size: 18px; "/>
                                                        </f:facet>
                                                    </p:cellEditor>
                                                </p:column>
                                                <p:column styleClass="TexAlCenter">
                                                    <f:facet name="header">
                                                        <h:outputText value="Dedicación [hs/semana]"
                                                                      style="font-weight: bold;"
                                                                      title="Ingrese las horas dedicadas al proyecto por semana."/>
                                                    </f:facet>
                                                    <p:cellEditor>
                                                        <f:facet name="output">
                                                            <!--<h:outputText id="horasdedicacion" value="# {agentea.horasdisponibles}" title="Horas que va a dedicar el agente al proyecto por semana." />-->
                                                            <p:inputText id="horasdedicacion"
                                                                         value="#{agentea.horasdisponibles}"
                                                                         disabled="#{agentea.consultorexterno eq 'TRUE'}"
                                                                         maxlength="2" size="2"
                                                                         title="Horas que va a dedicar el agente al proyecto por semana."/>
                                                            <p:tooltip id="toolTipHorasDedicacion" for="horasdedicacion"
                                                                       showEvent="focus" hideEvent="blur"/>
                                                        </f:facet>
                                                        <f:facet name="input">
                                                            <p:inputText id="ihorasdisponibles"
                                                                         value="#{agentea.horasdisponibles}"
                                                                         disabled="#{agentea.consultorexterno eq 'TRUE'}"
                                                                         maxlength="2" size="2"
                                                                         title="Horas que va a dedicar el agente al proyecto por semana."/>
                                                            <p:tooltip id="toolTipInputHorasDedicacion"
                                                                       for="ihorasdisponibles" showEvent="focus"
                                                                       hideEvent="blur"/>
                                                        </f:facet>
                                                    </p:cellEditor>
                                                </p:column>
                                                <p:column styleClass="TexAlCenter">
                                                    <f:facet name="header">
                                                        <h:outputText value="Honorario * mes" style="font-weight: bold;"
                                                                      title="Ingrese el monto a cobrar por mes en concepto de honorarios."/>
                                                    </f:facet>
                                                    <p:cellEditor>
                                                        <f:facet name="output">

                                                            <p:inputText id="honorario" value="#{agentea.honorario}"
                                                                         disabled="#{agentea.consultorexterno eq 'FALSE'}"
                                                                         maxlength="8" size="8"
                                                                         title="Honorario que el Consultor Externo cobra"/>
                                                            <p:tooltip id="toolTipHonorario" for="honorario"
                                                                       showEvent="focus" hideEvent="blur"/>
                                                        </f:facet>
                                                        <f:facet name="input">
                                                            <p:inputText id="ihonorario" value="#{agentea.honorario}"
                                                                         disabled="#{agentea.consultorexterno eq 'FALSE'}"
                                                                         maxlength="8" size="8"
                                                                         title="Honorario que el Consultor Externo cobra"/>
                                                            <p:tooltip id="toolTipInputHonorario" for="ihonorario"
                                                                       showEvent="focus" hideEvent="blur"/>
                                                        </f:facet>
                                                    </p:cellEditor>
                                                </p:column>


                                                <p:column>
                                                    <f:facet name="header">
                                                        <h:outputText value="&nbsp;"/>
                                                    </f:facet>
                                                    <p:commandButton immediate="true" id="cborrardeequipo" icon="fa fa-user-times"
                                                                     title="Quitar del Equipo de Trabajo"
                                                                     update="agentesa" styleClass="RedButton White">
                                                        <p:collector value="#{agentea}"
                                                                     removeFrom="#{proyectoAgenteController.equipotrabajo}"
                                                                     unique="true"/>
                                                    </p:commandButton>
                                                </p:column>
                                            </p:dataTable>

                                        </div>


                                    </p:tab>

                                    <p:tab id="paneletapas" title="Plan de Trabajo">
                                        <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-10 Padding15px, ui-grid-col-2 Padding15px" >

                                            <div class="CardTopic">
                                                <i class="icon-calendar Fs30 Fleft MarRight10"></i>
                                                <div class="EmptyBox10 ShowOnMobile"></div>
                                                Agregar Etapas y Tareas al Plan  <br/>
                                                <span class="CardSubTopic"> Especificar las etapas, tareas y los recursos a utilizar en cada una de ellas. </span>
                                            </div>

                                            <p:commandButton id="btn_addetapa" alt="Agregar Etapa"
                                                             update=":forme:etapa :forme:resultadoesperado :forme:tareasdeproyecto"
                                                             icon="fa fa-plus"
                                                             styleClass="GreenButton White"
                                                             action="#{etapaController.rearmarEtapasProyecto}"
                                                             onclick="PF('dialogoetapa').show();" immediate="true"
                                                             style="margin-top: 5px; margin-bottom: 5px; " title="Agregar Etapa al Proyecto" />
                                        </p:panelGrid>

                                        <p:tooltip for="btn_addetapa" />

                                        <p:treeTable id="treetableetapas" value="#{etapaController.root}" emptyMessage="No hay etapas agregadas al proyecto."
                                                     var="document" styleClass="tablaArbol tablaAjustada TablaColorEncabezado">

                                            <p:column headerText="Etapa/Tarea">
                                                <h:outputText value="#{document.tarea}"/>
                                            </p:column>
                                            <p:column headerText="Fecha Inicio">
                                                <h:outputText value="#{document.fechainicio}">
                                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                </h:outputText>
                                            </p:column>
                                            <p:column headerText="Fecha Fin">
                                                <h:outputText value="#{document.fechafin}">
                                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                </h:outputText>
                                            </p:column>
                                            <p:column headerText="Dias">
                                                <h:outputText value="#{document.dias}">

                                                </h:outputText>
                                            </p:column>
                                            <p:column headerText="Equipo">

                                                <ui:repeat value="#{document.tareaAgenteList}" var="ta">
                                                    <p:outputLabel
                                                            value="#{ta.agenteid.apellido},#{ta.agenteid.nombres} (#{ta.funcion})"/>
                                                    <br/>

                                                </ui:repeat>
                                            </p:column>
                                            <p:column>
                                                <p:commandButton title="Editar" rendered="#{document.estado eq null}"
                                                                 onclick="PF('dialogoetapa').show()"
                                                                 update=":forme:etapa :forme:tareasdeproyecto :forme:cetapa "
                                                                 action="#{etapaController.prepararEditarEtapaTreeTable(document)}"
                                                                 icon="ui-icon-search" immediate="true"
                                                                 style="margin: 3px;"/>

                                                <p:commandButton title="Eliminar"
                                                                 update=":form:tabview1:treetableetapas :form:tabview1:contenedor :form:beanvalue"
                                                                 rendered="#{document.estado eq null}"
                                                                 onclick="crearGrafico();"
                                                                 actionListener="#{etapaController.eliminarEtapaTreeTable(document)}"
                                                                 icon="ui-icon-trash" style="margin: 3px;"/>
                                            </p:column>

                                        </p:treeTable>

                                        <h:commandLink>
                                            <p:graphicImage value="/resources/img/excel.png"/>
                                            <p:dataExporter type="xls" target="tareasdeproyecto" fileName="tareas"/>
                                        </h:commandLink>

                                        <h:commandLink>
                                            <p:graphicImage value="/resources/img/pdf.png"/>
                                            <p:dataExporter type="pdf" target="tareasdeproyecto" fileName="tareas"/>
                                        </h:commandLink>

                                        <h:commandLink>
                                            <p:graphicImage value="/resources/img/csv.png"/>
                                            <p:dataExporter type="csv" target="tareasdeproyecto" fileName="tareas"/>
                                        </h:commandLink>

                                        <h:commandLink>
                                            <p:graphicImage value="/resources/img/xml.png"/>
                                            <p:dataExporter type="xml" target="tareasdeproyecto" fileName="tareas"/>
                                        </h:commandLink>
                                        <br/>
                                        <br/>
                                        <p:panel id="contenedor" header="Gantt" toggleable="true"
                                                 toggleTitle="Ver Gantt">

                                            <div id="containergrafico">


                                            </div>
                                        </p:panel>

                                    </p:tab>

                                    <p:tab title="Presupuesto">

                                        <p:treeTable id="tablepresupuesto" value="#{presupuestoTareaController.root}"
                                                     var="item"
                                                     style="padding: 0px; width: 100%; margin: 0 auto; overflow: hidden;">

                                            <p:column headerText="Etapa">
                                                <h:outputText value="#{item.descripcion}"/>
                                            </p:column>
                                            <p:column headerText="Rubro">
                                                <h:outputText value="#{item.rubro.rubro}"/>
                                            </p:column>
                                            <p:column headerText="Costo Unitario">
                                                <h:outputText value="#{item.costounitario}"/>
                                            </p:column>
                                            <p:column headerText="Cantidad">
                                                <h:outputText value="#{item.cantidad}"/>
                                            </p:column>
                                            <p:column headerText="Aporte Comitente">
                                                <h:outputText value="#{item.aportecomitente}"/>
                                            </p:column>
                                            <p:column headerText="Aporte Univeridad">
                                                <h:outputText value="#{item.aporteuniversidad}"/>
                                            </p:column>
                                            <p:column headerText="Aporte Organismo">
                                                <h:outputText value="#{item.aporteorganismo}"/>
                                            </p:column>
                                            <p:column headerText="Total">
                                                <h:outputText value="#{item.total}"/>
                                            </p:column>
                                            <p:columnGroup type="footer">
                                                <p:row>
                                                    <p:column colspan="4" style="text-align:right"
                                                              footerText="Totales:"/>

                                                    <p:column
                                                            footerText="#{presupuestoTareaController.sumagastocomitente}"/>

                                                    <p:column
                                                            footerText="#{presupuestoTareaController.sumagastouniversidad}"/>

                                                    <p:column
                                                            footerText="#{presupuestoTareaController.sumagastoorganismo}"/>

                                                    <p:column footerText="#{presupuestoTareaController.sumatotal}"/>

                                                </p:row>
                                            </p:columnGroup>
                                        </p:treeTable>

                                        <div align="center">
                                            <h:panelGrid id="pchartpresupuesto" columns="2" styleClass="left,right">
                                                <p:chart type="pie" id="chartaportes"
                                                         model="#{presupuestoTareaController.pieModelAportes}"
                                                         style="width:15%;height:300px"/>
                                                <p:chart type="pie" id="chartrubros"
                                                         model="#{presupuestoTareaController.pieModelRubros}"
                                                         style="width:15%;height:300px"/>

                                            </h:panelGrid>
                                        </div>
                                    </p:tab>

                                    <p:tab title="Documentación">

                                        <p:fieldset legend="Archivos">
                                            <h:panelGrid cellpadding="2" cellspacing="10" columnClasses="right,left"
                                                         columns="3">

                                                <h:form id="fupload" enctype="multipart/form-data">
                                                    <p:fileUpload label="Documentacion para subir" id="documentacion"
                                                                  fileUploadListener="#{archivoproyectoController.handleFileUpload}"
                                                                  mode="advanced"
                                                                  sizeLimit="10000000" multiple="true" auto="true"
                                                                  allowTypes="/(\.|\/)(gif|jpe?g|png|doc|docx|pdf)$/"
                                                                  update=":form:tabview1:tdocumentacionnombre1">

                                                    </p:fileUpload>
                                                </h:form>

                                                <p:dataTable id="tdocumentacionnombre1" var="arc"
                                                             value="#{archivoproyectoController.collectorArchivoProyecto}"
                                                             rowIndexVar="indice"
                                                             styleClass="tabla tablaAjustada TablaColorEncabezado">
                                                    <p:column headerText="Archivos">
                                                        <h:outputText value="#{arc.nombre}"/>
                                                    </p:column>
                                                    <p:column headerText="">
                                                        <p:commandLink rendered="#{arc.proyectoid.id ==null}"
                                                                       immediate="true" value="Eliminar"
                                                                       action="#{archivoproyectoController.removerArchivoCollection}"
                                                                       update=":form:tabview1:tdocumentacionnombre1">
                                                            <f:setPropertyActionListener value="#{arc}"
                                                                                         target="#{archivoproyectoController.selected}"/>
                                                        </p:commandLink>
                                                    </p:column>
                                                </p:dataTable>

                                            </h:panelGrid>
                                        </p:fieldset>

                                    </p:tab>
                                </p:tabView>
                            </div>
                        </div>
                    </div>

                    <div align="center">
                        <p:commandButton value="Enviar para evaluacion"
                                         actionListener="#{proyectoController.enviarEvaluarProyecto}"/>
                    </div>
                    <br/>

                    <h:inputHidden value="#{etapaController.gsoncategoria}" id="beanvalue"/>

                </h:form>

                <h:form id="formd">

                    <p:dialog id="dtarea" header="Tarea en Etapa #{etapaController.selected.etapa}" widgetVar="dtarea"
                              resizable="false" onShow="PF('wizardtarea').select(0);" responsive="true"
                              showEffect="clip" hideEffect="fold" modal="true">

                        <p:tabView id="wizardtarea" activeIndex="0" widgetVar="wizardtarea" styleClass="Container">

                            <p:tab id="tab1" title="Tarea" >

                                <p:outputLabel value="Título de la Tarea:" for="tarea" styleClass="Blue FontBold PaddingTopPercent10 "/> <br />
                                <p:inputText size="100" required="true" id="tarea" value="#{tareaController.selected.tarea}" title="Tarea" styleClass="MargenArriba5pxAbajo10px" /> <br />

                                <p:outputLabel value="Descripcion:" for="descripciontarea" styleClass="Blue FontBold PaddingTopPercent10" /> <br />
                                <p:inputTextarea cols="100" rows="3" id="descripciontarea" value="#{tareaController.selected.descripcion}" title="Descripcion" styleClass="MargenArriba5pxAbajo10px"/> <br />

                                <p:outputLabel value="Información" styleClass="Blue FontBold MarBot10"  /> <br />

                                <div class="Container100">
                                    <p:panelGrid styleClass="Container100 ui-panelgrid-blank" >
                                        <p:row>
                                            <p:column>
                                                <p:outputLabel value="Fecha de Inicio:" for="fechainicio" styleClass="FontBold" />
                                            </p:column>
                                            <p:column styleClass="center">
                                                <p:calendar size="11" required="true" id="fechainicio" showOn="button"
                                                            value="#{tareaController.selected.fechainicio}"
                                                            title="Fechainicio">
                                                    <p:ajax event="dateSelect" update=":formd:wizardtarea:dfechafin"/>
                                                </p:calendar>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel style="font-weight: bold" value="Dias:" for="dias"/>
                                            </p:column>
                                            <p:column styleClass="center">
                                                <p:spinner size="5" min="1" required="true" id="dias"
                                                           value="#{tareaController.selected.dias}" title="Dias">
                                                    <p:ajax event="change" listener="#{tareaController.sumarDias}"
                                                            update=":formd:wizardtarea:dfechafin" process="@this"/>
                                                    <p:ajax event="keyup" listener="#{tareaController.sumarDias}"
                                                            update=":formd:wizardtarea:dfechafin" process="@this"/>
                                                </p:spinner>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel style="font-weight: bold" value="Fecha Fin:" for="dfechafin"/>
                                            </p:column>
                                            <p:column styleClass="center">
                                                <p:calendar size="11" id="dfechafin" required="true" showOn="button"
                                                            value="#{tareaController.selected.fechafin}" title="Fechafin">
                                                    <p:ajax event="dateSelect"
                                                            listener="#{tareaController.calcularDiferenciaDias}"
                                                            update=":formd:wizardtarea:dias"/>
                                                </p:calendar>
                                            </p:column>
                                        </p:row>
                                        <p:row>
                                            <p:column>
                                                <p:outputLabel style="font-weight: bold" value="Prioridad:" for="prioridad"/>
                                            </p:column>
                                            <p:column styleClass="center">
                                                <p:selectOneMenu id="prioridad"
                                                                 value="#{tareaController.selected.prioridad}">
                                                    <p:ajax update="@this"/>
                                                    <f:selectItem itemLabel="Alta" itemValue="Alta"/>
                                                    <f:selectItem itemLabel="Media" itemValue="Media"/>
                                                    <f:selectItem itemLabel="Baja" itemValue="Baja"/>
                                                </p:selectOneMenu>
                                            </p:column>
                                            <p:column>
                                                <p:outputLabel style="font-weight: bold" value="Avance:"/>
                                            </p:column>
                                            <p:column colspan="2">
                                                <p:slider minValue="0" maxValue="100" for="iavance"/>
                                            </p:column>
                                            <p:column styleClass="center">
                                                <p:inputText size="8" id="iavance"
                                                             value="#{tareaController.selected.avance}" title="Avance"/>
                                                <p:outputLabel style="font-weight: bold" value="%"/>
                                            </p:column>
                                        </p:row>
                                    </p:panelGrid>
                                </div>


                            </p:tab>

                            <p:tab id="tab2" title="Equipo de trabajo">

                                <p:panelGrid columns="3" layout="grid" styleClass="ui-grid-col-12, ui-panelgrid-blank" columnClasses="ui-grid-col-4, ui-grid-col-7, ui-grid-col-1">
                                    <p:outputLabel value="Agregar Personas a Tarea"  styleClass="Blue FontBold Fs14" for="advancedfiltro" />
                                    <p:selectOneMenu id="advancedfiltro" value="#{agenteViewController.selected}" filter="true" filterMatchMode="contains" styleClass="ui-grid-col-12">
                                        <p:ajax update="@this"/>
                                        <f:selectItems value="#{agenteViewController.itemsAvailableSelectOneProyectoAgente}"/>
                                    </p:selectOneMenu>
                                    <p:commandButton id="botonAgregarPersonaTarea" onclick="PF('dialogotareaagentepresupuesto').show()"
                                                     title="Agregar Persona a la Tarea"
                                                     update=":formd:paneltareaagentepresupuesto"
                                                     actionListener="#{tareaAgenteController.armarTareaAgentePresupuesto()}"
                                                     icon="fa fa-plus" styleClass="GreenButton White">
                                    </p:commandButton>
                                </p:panelGrid>

                                <p:tooltip for="botonAgregarPersonaTarea" />

                                <p:dataTable id="tagentes" value="#{tareaAgenteController.tareasagentes}"
                                             var="tareaagente"
                                             editable="true" editMode="cell"
                                             rowIndexVar="indice"
                                             styleClass="tabla tablaAjustada TablaColorEncabezado"
                                        >

                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="CUIL"/>
                                        </f:facet>
                                        <h:outputText value="#{tareaagente.agenteid.cuil}"/>
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Nombre y Apellido"/>
                                        </f:facet>
                                        <h:outputText value="#{tareaagente.agenteid.apellido}, #{tareaagente.agenteid.nombres}"/>
                                    </p:column>
                                    <p:column headerText="Función">
                                        <h:outputText value="#{tareaagente.funcion}"/>
                                    </p:column>
                                    <p:column headerText="Dedicación">
                                        <h:outputText value="#{tareaagente.horasdedicadas eq null ? 'No aplicable':tareaagente.horasdedicadas}"/>
                                    </p:column>
                                    <p:column headerText="Honorarios/Mes">
                                        <h:outputText value="#{tareaagente.horasdedicadas eq null ? 'No aplicable': tareaagente.horasdedicadas * tareaagente.costoUnitarioCargoLegajo.floatValue}" />
                                    </p:column>

                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="&nbsp;"/>
                                        </f:facet>

                                        <p:commandButton id="cborrara" immediate="true" icon="fa fa-trash" styleClass="RedButton White"
                                                         title="Eliminar"
                                                         actionListener="#{tareaAgenteController.eliminarTareaAgente(tareaagente)}"
                                                         update="tagentes :formd:wizardtarea:tabrubros">
                                        </p:commandButton>
                                        <p:tooltip for="cborrara" />
                                    </p:column>
                                </p:dataTable>

                            </p:tab>

                            <p:tab id="tab3" title="Presupuesto/Tarea">

                                <p:tabView id="tabrubros" value="#{rubroController.rubroslist}" var="rub"
                                           orientation="left">
                                    <p:tab title="#{rub.abreviado}">

                                        <p:commandButton rendered="#{item.rubro.id.intValue() ne 5}"
                                                         id="cagregarpresupuestotarea"
                                                         value="Agregar Presupuesto a la Tarea"
                                                         onclick="PF('dialogopresupuesto').show()"
                                                         update=":formd:wizardtarea:tabrubros :formpresupuesto:panelpresupuesto"
                                                         action="#{presupuestoTareaController.reinit(rub)}"/>

                                        <p:dataTable id="tablepresupuestotarea"
                                                     value="#{presupuestoTareaController.buscarRubroenlistaPresupuestoTarea(rub)}"
                                                     var="item"
                                                     rowIndexVar="indice"
                                                     styleClass="tabla tablaAjustada TablaColorEncabezado">
                                            <f:facet name="header">
                                                Rubro #{rub.rubro}
                                            </f:facet>

                                            <p:column headerText="Descripción">
                                                <h:outputText value="#{item.descripcion}"/>
                                            </p:column>
                                            <p:column headerText="Aporte Comitente">
                                                <h:outputText value="#{item.aportecomitente}"/>
                                            </p:column>
                                            <p:column headerText="Aporte Universidad">
                                                <h:outputText value="#{item.aporteuniversidad}"/>
                                            </p:column>
                                            <p:column headerText="Aporte Organismo">
                                                <h:outputText value="#{item.aporteorganismo}"/>
                                            </p:column>
                                            <p:column headerText="Total">
                                                <h:outputText value="#{item.total}"/>
                                            </p:column>
                                            <p:column headerText="">
                                                <p:commandButton
                                                        rendered="#{item.rubro.id != 4 and (item.rubro.id != 5) }"
                                                        icon="ui-icon-trash" title="Eliminar"
                                                        update=":form:tabview1:tablepresupuesto :formd:wizardtarea:tabrubros"
                                                        action="#{presupuestoTareaController.eliminarPresupuesto(item)}"
                                                        process=":formd:wizardtarea:tabrubros"/>
                                            </p:column>
                                            <p:columnGroup type="footer">
                                                <p:row>
                                                    <p:column footerText="Totales"/>

                                                    <p:column
                                                            footerText="$#{presupuestoTareaController.sumaraportesComitenteRubroenlistaPresupuestoTarea(rub)}"/>

                                                    <p:column
                                                            footerText="$#{presupuestoTareaController.sumaraportesUniversidadRubroenlistaPresupuestoTarea(rub)}"/>

                                                    <p:column
                                                            footerText="$#{presupuestoTareaController.sumaraportesOrganismoRubroenlistaPresupuestoTarea(rub)}"/>

                                                    <p:column
                                                            footerText="$#{presupuestoTareaController.sumaraportesTotalesRubroenlistaPresupuestoTarea(rub)}"/>

                                                    <p:column footerText=""/>
                                                </p:row>
                                            </p:columnGroup>

                                        </p:dataTable>


                                    </p:tab>
                                </p:tabView>

                            </p:tab>

                        </p:tabView>

                        <f:facet name="footer">
                            <div align="center">

                                <p:commandButton id="botontareaok" value="OK" oncomplete="PF('dtarea').hide();"
                                                 actionListener="#{tareaController.armarTareasProyecto}"
                                                 update=":forme:tareasdeproyecto"></p:commandButton>

                            </div>
                        </f:facet>

                    </p:dialog>

                    <p:dialog id="dialogotareaagentepresupuesto" maximizable="false" modal="true" minimizable="false"
                              header="Agente * Tarea * Presupuesto" closable="true" resizable="false"
                              widgetVar="dialogotareaagentepresupuesto">
                        <p:panel id="paneltareaagentepresupuesto">
                            <div align="center"><p:outputLabel style="font-weight: bold"
                                                               value=" Agente: #{agenteViewController.selected.cuil} - #{agenteViewController.selected.apellido}, #{agenteViewController.selected.nombres}"/>
                            </div>
                            <br/>
                            <h:panelGrid columns="2">

                                <p:outputLabel value="Funcion en la tarea:" for="funcion"/>

                                <p:inputText size="100" id="funcion" value="#{tareaAgenteController.current2.funcion}"/>
                            </h:panelGrid>
                            <br/>
                            <h:panelGrid columns="2">
                                <p:outputLabel rendered="#{tareaAgenteController.current2.horasdedicadas > -1}"
                                               value="Horas dedicadas:" for="horasdedicadas"/>
                                <p:inputText size="10" rendered="#{tareaAgenteController.current2.horasdedicadas > -1}"
                                             id="horasdedicadas"
                                             value="#{tareaAgenteController.current2.horasdedicadas}"
                                             title="Horas Dedicadas">
                                    <p:ajax event="keyup" listener="#{tareaAgenteController.onCellEdit()}"
                                            update=":formd:totalpresupuesto"/>
                                </p:inputText>
                            </h:panelGrid>
                            <br/>
                            <p:separator/>
                            <br/>

                            <div align="center">
                                <h:panelGrid columns="4">

                                    <p:outputLabel style="font-weight: bold" value="Costo unitario:"/>
                                    <p:outputLabel style="font-weight: bold" id="costounitario"
                                                   value="#{presupuestoTareaController.current2.costounitario}"
                                                   title="Costounitario">
                                        <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                    </p:outputLabel>

                                    <p:outputLabel style="font-weight: bold" value="Cantidad:" for="cantidad"/>
                                    <p:outputLabel style="font-weight: bold" id="cantidad"
                                                   value="#{presupuestoTareaController.current2.cantidad}"
                                                   title="Cantidad">
                                        <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                    </p:outputLabel>
                                </h:panelGrid>
                                <h:panelGrid columns="2">

                                    <p:outputLabel style="font-weight: 900" value="Total:" for="totalpresupuesto"/>
                                    <p:outputLabel style="font-weight: 900" id="totalpresupuesto"
                                                   value="$#{presupuestoTareaController.current2.total}" title="Total">

                                    </p:outputLabel>

                                </h:panelGrid>
                                <br/>
                                <h:panelGrid columns="6">
                                    <p:outputLabel value="Aporte comitente:" for="aportecomitente"/>

                                    <p:inputText size="10" id="aportecomitente"
                                                 value="#{presupuestoTareaController.current2.aportecomitente}"
                                                 title="Aportecomitente" validatorMessage="Ingrese solo números">
                                        <!--<f:validateDoubleRange minimum="0.00" maximum="15000000.00" />-->
                                        <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                        <p:ajax event="keyup"
                                                listener="#{presupuestoTareaController.verificarAportes2}"/>
                                    </p:inputText>
                                    <p:outputLabel value="Aporte universidad:" for="aporteuniversidad"/>
                                    <p:inputText size="10" id="aporteuniversidad"
                                                 value="#{presupuestoTareaController.current2.aporteuniversidad}"
                                                 title="Aporteuniversidad">
                                        <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                        <p:ajax event="keyup"
                                                listener="#{presupuestoTareaController.verificarAportes2}"/>
                                    </p:inputText>
                                    <p:outputLabel value="Aporte organismo:" for="aporteorganismo"/>
                                    <p:inputText size="10" id="aporteorganismo"
                                                 value="#{presupuestoTareaController.current2.aporteorganismo}"
                                                 title="Aporteorganismo">
                                        <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                        <p:ajax event="keyup"
                                                listener="#{presupuestoTareaController.verificarAportes2}"/>
                                    </p:inputText>
                                </h:panelGrid>
                            </div>
                            <br/>

                            <div align="center">
                                <p:commandButton id="agregaralpresupuesto" value="OK"
                                                 action="#{tareaAgenteController.agregarEquipo()}"
                                                 update=":formpresupuesto:growlpresupuesto :formpresupuesto:panelpresupuesto :form:tabview1:tablepresupuesto :form:tabview1:pchartpresupuesto :form:tabview1:chartaportes :form:tabview1:chartrubros :formd:wizardtarea:tabrubros :formd:wizardtarea:tagentes "
                                                 oncomplete="handleTareaAgentePresupuestoRequest(xhr, status, args)">

                                </p:commandButton>

                            </div>
                        </p:panel>
                    </p:dialog>

                </h:form>

                <!--
                    *******************************************************
                                DIALOGO ETAPA
                    *******************************************************
                -->

                <h:form id="forme">
                    <p:dialog id="dialogoetapa" widgetVar="dialogoetapa"
                              maximizable="false" minimizable="false" showHeader="true"
                              closable="true" closeOnEscape="true"
                              resizable="false" modal="true" responsive="true" >

                        <p:growl id="msgs" showDetail="true"/>

                        <div class="CardTopic">
                            <i class="icon-calendar Fs30 Fleft MarRight10"></i>
                            <div class="EmptyBox10 ShowOnMobile"></div>
                            Etapas y Tareas
                        </div>

                        <div class="SeparatorFull" />

                        <p:panelGrid columns="2" layout="grid" styleClass="ui-grid-col-12 ui-panelgrid-blank" columnClasses="ui-grid-col-4, ui-grid-col-8" style="margin-bottom: 10px;" >
                            <p:outputLabel value="Nombre de Etapa:" for="etapa" styleClass="FontBold Blue "/>
                            <p:inputText id="etapa" value="#{etapaController.selected.etapa}" title="Etapa" styleClass="ui-grid-col-12"/>

                            <p:outputLabel value="Resultado Esperado:" for="etapa"  styleClass="FontBold Blue"/>
                            <p:inputTextarea id="resultadoesperado" rows="4" value="#{etapaController.selected.resultadoesperado}" title="Etapa" styleClass="ui-grid-col-12"/>
                        </p:panelGrid>

                        <div class="Separator" />

                        <div class="CardTopic">
                            <i class="icon-task Fs30 Fleft MarRight10" style="padding-top: 5px;"></i>
                            <div class="EmptyBox10 ShowOnMobile"></div>
                            Agregar Tareas a la Etapa
                            <p:commandButton update=":formd:wizardtarea" id="btn_add"
                                             action="#{tareaController.rearmarTareasProyecto}"
                                             onclick="PF('dtarea').show();" title="Agregar Tarea" immediate="true" icon="fa fa-plus"
                                             style="margin-top: 5px; margin-bottom: 5px;" styleClass="GreenButton White"
                                    />

                            <p:tooltip for="btn_add" />
                        </div>

                        <p:dataTable id="tareasdeproyecto" value="#{tareaController.tareasdeproyecto}" var="item"
                                     widgetVar="wtareasdeproyecto" styleClass="tabla tablaAjustada ui-grid-col-12" emptyMessage="No hay tareas cargadas en la etapa actual.">

                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Tarea"/>
                                </f:facet>
                                <p:outputLabel value="#{item.tarea}" styleClass="Celeste"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Inicio"/>
                                </f:facet>
                                <p:outputLabel value="#{item.fechainicio}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>

                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Fin"/>
                                </f:facet>
                                <p:outputLabel value="#{item.fechafin}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>

                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Días"/>
                                </f:facet>
                                <p:outputLabel value="#{item.dias}"/>

                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Prioridad"/>
                                </f:facet>
                                <p:outputLabel value="#{item.prioridad}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Estado"/>
                                </f:facet>
                                <p:outputLabel value="#{item.estado} %" />
                            </p:column>

                            <p:column exportable="false">

                                <p:commandButton id="cborrar" immediate="true" title="Eliminar"
                                                 action="#{tareaController.removerTareadeProyecto}"
                                                 update=":forme:tareasdeproyecto :form:beanvalue :form:tabview1:treetableetapas " icon="fa fa-trash" styleClass="RedButton White">
                                    <f:setPropertyActionListener value="#{item}" target="#{tareaController.selected}"/>
                                </p:commandButton>
                                <br/>
                                <p:commandButton id="ceditar" immediate="true" value="Editar"
                                                 onclick="PF('dtarea').show()" update=":formd:wizardtarea"
                                                 action="#{tareaController.editarTarea(item)}" icon="fa fa-edit" styleClass="OrangeButton White">
                                    <f:setPropertyActionListener value="#{item}" target="#{tareaController.selected}"/>
                                </p:commandButton>
                            </p:column>

                        </p:dataTable>

                        <p:commandButton id="cetapa"
                                             update=":form:tabview1:contenedor :form:tabview1:treetableetapas :form:beanvalue :form:tabview1:tablepresupuesto "
                                             onclick="PF('dialogoetapa').hide();
                                        crearGrafico();" value="Guardar Etapa"
                                             actionListener="#{etapaController.agregaralListadoEtapas}" icon="fa fa-save" styleClass="GreenButton White TexAlCenter" style="margin-top: 10px;"/>


                    </p:dialog>
                    <p:dialog id="dfinal" widgetVar="dfinal" modal="true" closable="false"
                              header="Plan y equipo de trabajo de Proyecto Creado">
                        Felicitaciones la Creación del plan y Equipo de trabajo del Proyecto fue creada Satisfactoriamente!!!
                        <div align="center">

                            <h:panelGrid columns="2">
                                <p:commandButton value="Imprimir" actionListener="#{proyectoController.pdfEtapas()}"
                                                 ajax="false"/>
                                <p:commandButton value="OK" ajax="false"
                                                 actionListener="#{proyectoController.reiniciarValoresProyecto}"
                                                 action="List" onclick="PF('dfinal').hide();"/>
                            </h:panelGrid>

                        </div>

                    </p:dialog>

                </h:form>

                <h:form id="formresgistrar">
                    <p:dialog id="dialogoregistrar" maximizable="false"
                              minimizable="false" header="Registrar Persona" closable="true"
                              resizable="false" widgetVar="dregistrar">


                        <p:remoteCommand name="rc" update="msgs" actionListener="#{agenteViewController.registrar}"/>

                        <p:growl id="msgs" showDetail="true"/>
                        <h:panelGrid id="panel" columns="3">
                            <p:outputLabel value="Apellido" for="apellido"/>
                            <p:inputText maxlength="30" id="apellido" value="#{agenteViewController.agente1.apellido}"
                                         title="Apellido" required="true"/>
                            <p:message for="apellido"/>
                            <p:outputLabel value="Nombres" for="nombres"/>
                            <p:inputText maxlength="45" id="nombres" value="#{agenteViewController.agente1.nombres}"
                                         title="Nombres" required="true"/>
                            <p:message for="nombres"/>
                            <p:outputLabel value="Tipo de Documento" for="tipodocumentoid"/>
                            <p:selectOneMenu id="tipodocumentoid"
                                             value="#{agenteViewController.agente1.tipodocumentoid}"
                                             title="Tipo de Documento" required="true">
                                <f:selectItems value="#{tipodocumentoController.itemsAvailableSelectOne}"/>
                            </p:selectOneMenu>
                            <p:message for="tipodocumentoid"/>
                            <p:outputLabel value="N° de Documento" for="numerodocumento"/>
                            <p:inputText id="numerodocumento" value="#{agenteViewController.agente1.numerodocumento}"
                                         title="Numero de Documento" required="true"/>
                            <p:message for="numerodocumento"/>
                            <p:outputLabel value="Cuil" for="cuil"/>
                            <p:inputMask id="cuil" value="#{agenteViewController.agente1.cuil}" mask="99-99999999-9"/>
                            <p:message for="cuil"/>
                            <p:outputLabel value="Teléfono" for="telefono"/>
                            <p:inputText id="telefono" value="#{agenteViewController.agente1.telefono}" title="Telefono"
                                         required="true"/>
                            <p:message for="telefono"/>
                            <p:outputLabel value="Celular" for="celular"/>
                            <p:inputText id="celular" value="#{agenteViewController.agente1.celular}" title="Celular"
                                         required="false"/>
                            <p:message for="celular"/>
                            <p:outputLabel value="Email" for="email"/>
                            <p:inputText id="email" value="#{agenteViewController.agente1.email}"
                                         validatorMessage="Email Incorrecto" required="true">
                                <f:validateRegex
                                        pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]"/>
                            </p:inputText>
                            <p:message for="email"/>
                            <p:outputLabel value="Otro Email" for="otroemail"/>

                            <p:inputText id="otroemail" value="#{agenteViewController.agente1.otroemail}">
                                <!--   <f:validateRegex pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]" /> -->
                            </p:inputText>
                            <p:message for="otroemail"/>

                            <p:outputLabel value="Domicilio" for="domicilio"/>
                            <p:inputText maxlength="200" id="domicilio"
                                         value="#{agenteViewController.agente1.domicilio}" title="Domicilio"
                                         required="true"/>
                            <p:message for="domicilio"/>
                            <p:outputLabel value="Profesion" for="profesion"/>
                            <p:inputText maxlength="70" id="profesion" value="#{agenteViewController.agente1.profesion}"
                                         title="Profesion" required="true"/>
                            <p:message for="profesion"/>
                            <p:outputLabel value="Especialidad" for="especialidad"/>
                            <p:inputText maxlength="70" id="especialidad"
                                         value="#{agenteViewController.agente1.especialidad}" title="Especialidad"
                                         required="true"/>
                            <p:message for="especialidad"/>

                            <p:commandButton onclick="rc()" oncomplete="PF('dregistrar').hide()"
                                             update=":formd:wizardtarea:advancedfiltro :form:tabview1:advancedfiltroa"
                                             value="Crear"/>
                            <br/>


                        </h:panelGrid>


                    </p:dialog>

                </h:form>
                <h:form id="formpresupuesto">
                    <p:growl id="growlpresupuesto" showDetail="true" widgetVar="growlpresupuesto" autoUpdate="true"/>
                    <p:dialog id="dialogopresupuesto" maximizable="false"
                              minimizable="false" header="Presupuesto" closable="true"
                              resizable="false" widgetVar="dialogopresupuesto">
                        <p:panel id="panelpresupuesto">

                            <h:panelGrid columns="4">

                                <p:outputLabel value="Rubro:" for="rubro"/>

                                <p:inputText id="rubro" readonly="true"
                                             value="#{presupuestoTareaController.selected.rubro.rubro}"/>

                                <p:outputLabel value="Descripcion:" for="descripcion"/>
                                <p:inputText size="50" id="descripcion"
                                             value="#{presupuestoTareaController.selected.descripcion}" required="true"
                                             title="Descripcion"/>
                            </h:panelGrid>
                            <h:panelGrid columns="5">

                                <p:outputLabel value="Costo unitario:" for="costounitario"/>
                                <p:inputText id="costounitario"
                                             value="#{presupuestoTareaController.selected.costounitario}"
                                             title="Costounitario">
                                    <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                    <p:ajax event="keyup" listener="#{presupuestoTareaController.sumarTotalCurrent}"
                                            update="totalpresupuesto"/>
                                </p:inputText>
                                <p:message for="costounitario"/>
                                <p:outputLabel value="Cantidad:" for="cantidad"/>
                                <p:inputText size="10" id="cantidad"
                                             value="#{presupuestoTareaController.selected.cantidad}" title="Cantidad">
                                    <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                    <p:ajax event="keyup" listener="#{presupuestoTareaController.sumarTotalCurrent}"
                                            update="totalpresupuesto"/>
                                </p:inputText>
                            </h:panelGrid>
                            <h:panelGrid columns="6">
                                <p:outputLabel value="Aporte comitente:" for="aportecomitente"/>

                                <p:inputText size="10" id="aportecomitente"
                                             value="#{presupuestoTareaController.selected.aportecomitente}"
                                             title="Aportecomitente" validatorMessage="Ingrese solo números">
                                    <!--<f:validateDoubleRange minimum="0.00" maximum="15000000.00" />-->
                                    <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                    <p:ajax event="keyup" listener="#{presupuestoTareaController.verificarAportes}"/>
                                </p:inputText>
                                <p:outputLabel value="Aporte universidad:" for="aporteuniversidad"/>
                                <p:inputText size="10" id="aporteuniversidad"
                                             value="#{presupuestoTareaController.selected.aporteuniversidad}"
                                             title="Aporteuniversidad">
                                    <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                    <p:ajax event="keyup" listener="#{presupuestoTareaController.verificarAportes}"/>
                                </p:inputText>
                                <p:outputLabel value="Aporte organismo:" for="aporteorganismo"/>
                                <p:inputText size="10" id="aporteorganismo"
                                             value="#{presupuestoTareaController.selected.aporteorganismo}"
                                             title="Aporteorganismo">
                                    <f:convertNumber type="number" groupingUsed="false" locale="es_AR"/>
                                    <p:ajax event="keyup" listener="#{presupuestoTareaController.verificarAportes}"/>
                                </p:inputText>
                            </h:panelGrid>

                            <h:panelGrid columns="2">

                                <p:outputLabel value="Total:" for="totalpresupuesto"/>
                                <p:outputLabel id="totalpresupuesto"
                                               value="$#{presupuestoTareaController.selected.total}" title="Total">

                                </p:outputLabel>

                            </h:panelGrid>

                            <div align="center">
                                <p:commandButton id="agregaralpresupuesto" value="OK"
                                                 onclick="PF('dialogopresupuesto').hide()"
                                                 actionListener="#{presupuestoTareaController.agregarPresupuesto()}"
                                                 update=":formpresupuesto:growlpresupuesto :formpresupuesto:panelpresupuesto :form:tabview1:tablepresupuesto :form:tabview1:pchartpresupuesto :form:tabview1:chartaportes :form:tabview1:chartrubros :formd:wizardtarea:tabrubros">

                                </p:commandButton>

                            </div>
                        </p:panel>
                    </p:dialog>
                </h:form>


                <script type="text/javascript">
                    $(function crearGrafico() {
                        var chart;

                        chart = new Highcharts.Chart({
                            chart: {
                                renderTo: "containergrafico",
                                type: 'columnrange',
                                inverted: true
                            },
                            exporting: {
                                enabled: true
                            },
                            title: {
                                text: 'Proyecto N° #{proyectoController.selected.id} - #{proyectoController.selected.nombre}'
                            },
                            xAxis: {
                                categories: []

                            },
                            yAxis: {
                                tickInterval: 7 * 24 * 3600 * 1000,
                                title: 'Date',
                                type: 'datetime',
                                dateTimeLabelFormats: {
                                    week: '%e. %b'
                                },
                                stackLabels: {
                                    style: {
                                        color: 'white'
                                    },
                                    enabled: true,
                                    verticalAlign: 'middle',
                                    align: 'left'
                                }
                            },
                            tooltip: {
                                formatter: function () {

                                    return '<b>' + this.series.name + ':</b> ' + Highcharts.dateFormat('%e %b, %Y', this.point.low) + ' - ' + Highcharts.dateFormat('%e %b, %Y', this.point.high) + '<br/>';
                                }
                            },
                            legend: {
                                enabled: true
                            },
                            series: [{
                                name: 'Inicio - Fin',
                                data: #{etapaController.data}
                            }, {
                                name: 'Actual',
                                data: #{etapaController.dataactual},
                                color: 'yellow'
                            }]
                        });
                        Highcharts.setOptions({
                            lang: {
                                loading: 'Cargando...',
                                months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                                weekdays: ['Domingo', 'Lunes', 'Martes', 'Miercoles', 'Jueves', 'Viernes', 'Sábado'],
                                shortMonths: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                                exportButtonTitle: 'Exportar',
                                printButtonTitle: 'Importar',
                                rangeSelectorFrom: 'De',
                                rangeSelectorTo: 'A',
                                rangeSelectorZoom: 'Periodo',
                                downloadPNG: 'Descargar gráfico PNG',
                                downloadJPEG: 'Descargar gráfico JPEG',
                                downloadPDF: 'Descargar gráfico PDF',
                                downloadSVG: 'Descargar gráfico SVG',
                                printChart: 'Imprimir Gráfico',
                                thousandsSep: ',',
                                decimalPoint: '.'
                            }
                        });
                        //chart.series[1].setData(eval(oneArray), false, true);
                        // chart.series[0].setData(, false, true);
                        chart.xAxis[0].setCategories(#{etapaController.gsoncategoria}, true, true);
                    });
                </script>
                <script type="text/javascript">
                    function handleTareaAgentePresupuestoRequest(xhr, status, args) {
                        if (!args.validation) {
                            PF('dialogotareaagentepresupuesto').jq.effect("shake", {times: 5}, 100);
                        }
                        else {
                            PF('dialogotareaagentepresupuesto').hide();

                        }
                    }
                </script>
            </div>
        </div>
    </ui:define>
</ui:composition>

</html>
